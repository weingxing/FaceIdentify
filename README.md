# FaceIdentify

基于FaceNet和CenterFace实现的人脸识别
使用CenterFace进行人脸检测，获取到五个关键点后，做仿射变换进行人脸对齐。

使用FaceNet提取处理后的图片的特征向量，与数据库中存在的特征向量进行比对（计算量特征向量的欧氏距离），
输出结果为距离最小的类别，通过设置最大距离来限制误识。

## 数据获取
在网上找到的亚洲人脸的数据集仅有CASIA-FaceV5，数据量较少，
使用爬虫爬取数据（以明星为目标），对爬取的数据进行
清洗后作为训练集，使用CASIA-FaceV5作为测试集

### 数据爬取与清洗
代码位于[/src/train/pretreatment](./src/train/pretreatment)，
采集和清洗代码文件名第一位的数字为运行顺序，先运行1，获取明星的名单，
在运行2，采集图片，在运行3，删除损坏的图片，再运行4，删除有多个人的图片，再运行5，
删除空文件夹（经过以上操作可能会产生空文件夹），再运行6，删除不是同一个人的图片。

删除多余一个人的图片使用CenterFace进行人脸检测。

删除不是同一个人的图片使用百度人脸比对api进行比对处理。

最后，使用align_dataset.py对训练集和测试集进行预处理，供寻可怜模型使用。

## 训练
为方便使用Google Colab进行训练，训练代码为Jupyter格式，修改相应的参数后训练即可。
训练完成后的到的meta文件和checkpoint文件在使用时读取速度很慢，使用
export_model.py将模型导出为pb文件即可快速读取。

## GUI
使用PyQt5开发界面，所有视图均在[/src/view](./src/view)，
使用MySQL对提取的人脸特征和对应的信息进行存储，使用OpenCV实时采集图像，将采集的图像进行特征向量的
提取，然后与数据库中的信息比对，根据设置的最大距离来判断是不是同一个人。